C51 COMPILER V9.57.0.0   ONE_WIRE                                                          01/29/2026 11:26:44 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE ONE_WIRE
OBJECT MODULE PLACED IN .\Objects\one_wire.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE one_wire.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\
                    -one_wire.lst) OBJECT(.\Objects\one_wire.obj)

line level    source

   1          #include <STC15F2K60S2.H>
   2          #include <intrins.h> 
   3          sbit onewire_DQ=P1^4;
   4          
   5          void Delay10us(void)    //@12.000MHz
   6          {
   7   1              unsigned char data i;
   8   1      
   9   1              _nop_();
  10   1              _nop_();
  11   1              i = 27;
  12   1              while (--i);
  13   1      }
  14          
  15          void Delay50us(void)    //@12.000MHz
  16          {
  17   1              unsigned char data i;
  18   1      
  19   1              _nop_();
  20   1              _nop_();
  21   1              i = 147;
  22   1              while (--i);
  23   1      }
  24          
  25          void Delay5us(void)     //@12.000MHz
  26          {
  27   1              unsigned char data i;
  28   1      
  29   1              _nop_();
  30   1              _nop_();
  31   1              i = 12;
  32   1              while (--i);
  33   1      }
  34          
  35          
  36          
  37          void Delayus(unsigned int xus)  //@12.000MHz
  38          {
  39   1              unsigned char tem=xus/5;
  40   1              unsigned char data i;
  41   1              while(tem--)
  42   1              {
  43   2                      _nop_();
  44   2                      _nop_();
  45   2                      i = 12;
  46   2                      while (--i);
  47   2              }
  48   1      
  49   1      }
  50          
  51          unsigned char onewire_init(void)
  52          {
  53   1              unsigned char ackbit;
  54   1              onewire_DQ=1;
C51 COMPILER V9.57.0.0   ONE_WIRE                                                          01/29/2026 11:26:44 PAGE 2   

  55   1              onewire_DQ=0;
  56   1              Delayus(500);
  57   1              onewire_DQ=1;
  58   1              Delayus(70);
  59   1              ackbit=onewire_DQ;
  60   1              Delayus(500);
  61   1              return ackbit;
  62   1      }
  63          
  64          void onewire_sendbit(unsigned char Bit)
  65          {
  66   1              onewire_DQ=0;
  67   1              Delay10us();
  68   1              onewire_DQ=Bit;
  69   1              Delay50us();
  70   1              onewire_DQ=1;
  71   1      }
  72          
  73          unsigned char onewire_receivebit(void)
  74          {
  75   1              unsigned char Bit;
  76   1              onewire_DQ=0;
  77   1              Delay5us();
  78   1              onewire_DQ=1;
  79   1              Delay5us();
  80   1              Bit=onewire_DQ;
  81   1              Delay50us();
  82   1              return Bit;
  83   1      }
  84          
  85          void onewire_sendbyte(unsigned char byte)
  86          {
  87   1              unsigned char i;
  88   1              for(i=0;i<8;i++)
  89   1              {
  90   2                      onewire_sendbit(byte&(0x01<<i));
  91   2              }
  92   1      }
  93          
  94          unsigned char onewire_receivebyte(void)
  95          {
  96   1      
  97   1              unsigned char i;
  98   1              unsigned char byte=0x00;
  99   1              for(i=0;i<8;i++)
 100   1              {
 101   2                      if(onewire_receivebit()){byte|=(0x01<<i);}
 102   2              }
 103   1              return byte;
 104   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    172    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
